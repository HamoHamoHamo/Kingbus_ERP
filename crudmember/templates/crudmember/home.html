{% extends 'base.html' %}
{% load custom_tags %}
{% load static %}

{% block head %}
<link href="{% static 'css/crudmember/calender.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block content-header %}
<div class="HeaderTitle">
  <!-- 페이지별 Title 변경 -->
  HOME
</div>
{% endblock %}

{% block content %}

<form action="" method="get" id="sendMonth">
  <div class="searchAreaBox">
    <div class="controllBox">
      <div class="todayBtn">Today</div>
      <div class="controllBtnCell">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="8" height="13.993" viewBox="0 0 8 13.993">
            <path id="Icon_ionic-ios-arrow-back" data-name="Icon ionic-ios-arrow-back"
              d="M13.662,13.188,18.957,7.9a1,1,0,1,0-1.416-1.412l-6,5.995a1,1,0,0,0-.029,1.379L17.536,19.9a1,1,0,1,0,1.416-1.412Z"
              transform="translate(-11.251 -6.194)" fill="#fff" />
          </svg>
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="8" height="13.993" viewBox="0 0 8 13.993">
            <path id="Icon_ionic-ios-arrow-back" data-name="Icon ionic-ios-arrow-back"
              d="M16.839,13.188,11.544,7.9a1,1,0,0,1,1.416-1.412l6,5.995a1,1,0,0,1,.029,1.379L12.965,19.9a1,1,0,0,1-1.416-1.412Z"
              transform="translate(-11.251 -6.194)" fill="#fff" />
          </svg>
        </div>
      </div>
      <span></span>
    </div>
    <input type="hidden" name="month" class="hiddenMonth">
  </div>
</form>

<div class="contentsAreaBox">
  <div class="calenderBox">
    <table class="calenderTableHeader">
      <thead>
        <tr>
          <td>Sun</td>
          <td>Mon</td>
          <td>Tue</td>
          <td>Wed</td>
          <td>Thu</td>
          <td>Fri</td>
          <td>Sat</td>
        </tr>
      </thead>
    </table>
    <div class="calenderCreteTbody"></div>
  </div>
</div>


{% endblock %}



{% block popup %}

<div class="popupAreaModules">
  <div class="popupBgModules"></div>
  <form class="popupContainer">

    <div class="PopupTitle">보험/정비알림</div>

    <div class="PopupDataArea">
    </div>

    <div class="PopupBtnBox">
      <div class="btnModules">닫기</div>
    </div>

  </form>
</div>

<div class="popupAreaModulesDispatch">
  <div class="popupBgModules"></div>
  <form method="post" action="{% url 'dispatch:calendar_create' %}" class="popupContainer">
    {% csrf_token %}
    <div class="PopupTitle">배차지시서</div>

    <div class="PopupDataAreaDispatch">
      <div class="PopupDataCell">
        <span class="PopupDataTitle">날짜</span>
        <input name="date" type="text" class="PopupData fakeInput" readonly>
      </div>
      <div class="PopupDataCell">
        <span class="PopupDataTitle">확인1</span>
        <div class="haveDeleteIcon">
          <div class="PopupData check1"></div>
          <svg class="fileDeletBtn" xmlns="http://www.w3.org/2000/svg" width="14.829" height="14.542"
            viewBox="0 0 14.829 14.542">
            <g id="그룹_930" data-name="그룹 930" transform="translate(-3537.086 5807.914)">
              <line id="선_624" data-name="선 624" x2="11.706" y2="11.714" transform="translate(3538.5 -5806.5)"
                fill="none" stroke="#707070" stroke-linecap="round" stroke-width="2" />
              <line id="선_625" data-name="선 625" x1="11.706" y2="11.714" transform="translate(3538.794 -5806.5)"
                fill="none" stroke="#707070" stroke-linecap="round" stroke-width="2" />
            </g>
          </svg>
        </div>
      </div>
      <div class="PopupDataCell">
        <span class="PopupDataTitle">확인2</span>
        <div class="haveDeleteIcon">
          <div class="PopupData check2"></div>
          <svg class="fileDeletBtn" xmlns="http://www.w3.org/2000/svg" width="14.829" height="14.542"
            viewBox="0 0 14.829 14.542">
            <g id="그룹_930" data-name="그룹 930" transform="translate(-3537.086 5807.914)">
              <line id="선_624" data-name="선 624" x2="11.706" y2="11.714" transform="translate(3538.5 -5806.5)"
                fill="none" stroke="#707070" stroke-linecap="round" stroke-width="2" />
              <line id="선_625" data-name="선 625" x1="11.706" y2="11.714" transform="translate(3538.794 -5806.5)"
                fill="none" stroke="#707070" stroke-linecap="round" stroke-width="2" />
            </g>
          </svg>
        </div>
      </div>
      <div class="printBox">
          <div class="printCell" onclick="openLinePrint('/dispatch/print/line')">
            <svg xmlns="http://www.w3.org/2000/svg" width="23.1" height="20" viewBox="0 0 23.1 20">
              <path id="Icon_zocial-print" data-name="Icon zocial-print"
                d="M.18,23.96V15.635l2.9-3.225H5.2v1.6H3.8l-2,2.225V22.36H21.68V16.235l-2-2.225h-1.4v-1.6H20.4l2.875,3.225V23.96H.18ZM5.2,15.985V7.735L8.98,3.96h9.3V15.985H5.2ZM6.7,14.46H16.78v-9h-6.3V9.235H6.7Z"
                transform="translate(-0.18 -3.961)" />
            </svg>
            <span>노선별A4</span>
          </div>
          <div class="printCell" onclick="openBusPrintA4('/dispatch/print/bus')">
            <svg xmlns="http://www.w3.org/2000/svg" width="23.1" height="20" viewBox="0 0 23.1 20">
              <path id="Icon_zocial-print" data-name="Icon zocial-print"
                d="M.18,23.96V15.635l2.9-3.225H5.2v1.6H3.8l-2,2.225V22.36H21.68V16.235l-2-2.225h-1.4v-1.6H20.4l2.875,3.225V23.96H.18ZM5.2,15.985V7.735L8.98,3.96h9.3V15.985H5.2ZM6.7,14.46H16.78v-9h-6.3V9.235H6.7Z"
                transform="translate(-0.18 -3.961)" />
            </svg>
            <span>호수별A4</span>
          </div>
          <div class="printCell" onclick="openBusPrintA3('/dispatch/print/bus')">
            <svg xmlns="http://www.w3.org/2000/svg" width="23.1" height="20" viewBox="0 0 23.1 20">
              <path id="Icon_zocial-print" data-name="Icon zocial-print"
                d="M.18,23.96V15.635l2.9-3.225H5.2v1.6H3.8l-2,2.225V22.36H21.68V16.235l-2-2.225h-1.4v-1.6H20.4l2.875,3.225V23.96H.18ZM5.2,15.985V7.735L8.98,3.96h9.3V15.985H5.2ZM6.7,14.46H16.78v-9h-6.3V9.235H6.7Z"
                transform="translate(-0.18 -3.961)" />
            </svg>
            <span>호수별A3</span>
          </div>
          <div class="printCell" onclick="openDrivingListPrint('/dispatch/print/dailylist')">
            <svg xmlns="http://www.w3.org/2000/svg" width="23.1" height="20" viewBox="0 0 23.1 20">
              <path id="Icon_zocial-print" data-name="Icon zocial-print"
                d="M.18,23.96V15.635l2.9-3.225H5.2v1.6H3.8l-2,2.225V22.36H21.68V16.235l-2-2.225h-1.4v-1.6H20.4l2.875,3.225V23.96H.18ZM5.2,15.985V7.735L8.98,3.96h9.3V15.985H5.2ZM6.7,14.46H16.78v-9h-6.3V9.235H6.7Z"
                transform="translate(-0.18 -3.961)" />
            </svg>
            <span>운행일보A4</span>
          </div>
      </div>
      <input type="hidden" class="sendToHiddenChecker">
    </div>

    <div class="PopupBtnBoxDispatch">
      <div class="btnModules">닫기</div>
      <input type="submit" value="배차확인" class="btnModules">
    </div>

  </form>
</div>


{% endblock %}






{% block script %}
<script>
  const totalBusCnt = {{ total_bus_cnt }}
  const curBusCnt = {{ cur_bus_cnt }}
  const r_totalBusCnt = {{ r_total_bus_cnt }}
  const r_curBusCnt = {{ r_cur_bus_cnt }}

  console.log("일반배차 총 :", totalBusCnt)
  console.log("일반배차 :", curBusCnt)
  console.log("정기배차 총 :", r_totalBusCnt)
  console.log("정기배차 :", r_curBusCnt)

  {% autoescape off %}
  // console.log("AAAAAA", {{insurance_list}})
  // console.log("AAAAAA", {{check_list}})
  // console.log("AAAAAA", {{duration}})
  // console.log("AAAAAA", {{expire}})

  const alarm = [
    {% for vehicle in insurance_list %}
  {
    type: '보험',
      num : '{{vehicle.vehicle_num}}',
        duration: '{{vehicle.insurance_expiry_date}}'
  },
  {% endfor %}
  {% for vehicle in check_list %}
  {
    type: '차량정비',
      num : '{{vehicle.vehicle_num}}',
        duration: '{{duration|index:forloop.counter0}} ~ {{expire|index:forloop.counter0}}'
  }
  {% endfor %}
  ]
  const name1 = {{ check_id1 }}
  const name2 = {{ check_id2 }}
  console.log("alarm", alarm)
  console.log("name1", name1)
  console.log("name2", name2)
  {% endautoescape %}

  let targetLink = ""

  function openLinePrint(url){
        targetLink = `${url}?date=${fakeInput.value}`
        window.open(targetLink, "노선별A4", "width=800, height=640")
    }
  function openBusPrintA4(url){
        targetLink = `${url}?date=${fakeInput.value}&size=A4`
        window.open(targetLink, "호수별A4", "width=1170, height=640")
    }
  function openBusPrintA3(url){
        targetLink = `${url}?date=${fakeInput.value}&size=A3`
        window.open(targetLink, "호수별A3", "width=1660, height=640")
    }
  function openDrivingListPrint(url){
        targetLink = `${url}?date=${fakeInput.value}`
        window.open(targetLink, "운행일보A4", "width=1200, height=640")
    }

</script>
<script src="{% static 'js/crudmember/calender.js' %}"></script>
{% endblock %}